@startuml

skinparam defaultFontName "Arial"

title Онлайн-запись клиента на стрижку\n(диаграмма последовательности)

actor "Клиент" as Client
boundary "Веб-приложение" as Web
control "Сервис расписания" as Schedule
control "Сервис записи" as Booking
control "Сервис уведомлений" as Notify

Client -> Web: Открыть страницу записи
Web -> Schedule: Запросить услуги и свободные слоты
Schedule --> Web: Список услуг и слотов

alt Выбор по услуге
  Client -> Web: Выбрать услугу\n(просмотр каталога услуг)
  Web -> Schedule: Запросить мастеров и слоты\nпо выбранной услуге
  Schedule --> Web: Доступные мастера и слоты
else Выбор по мастеру
  Client -> Web: Выбрать мастера\n(просмотр каталога мастеров)
  Web -> Schedule: Запросить услуги и слоты\nпо выбранному мастеру
  Schedule --> Web: Доступные услуги и слоты
end

Client -> Web: Выбор конкретной услуги,\nмастера, даты и времени\nНажать «Записаться»
Web -> Booking: Создать запись\n(клиент, мастер, услуга, слот)

Booking -> Schedule: Проверить, свободен ли слот
Schedule --> Booking: Слот свободен / занят

alt Слот занят
  Booking --> Web: Ошибка «слот занят»
  Web --> Client: Показать сообщение\nи предложить свободные слоты
else Слот свободен
  Booking -> Schedule: Забронировать слот
  Schedule --> Booking: Подтверждение брони

  Booking -> Notify: Отправить уведомления\nклиенту и мастеру
  Notify --> Booking: Статус отправки

  Booking --> Web: Подтверждение записи
  Web --> Client: Показать детали записи
end

@enduml